# Compiles uml files into a variety of interesting formats.

# Define compiler and all uml files.
CC     = plantuml
UML    = $(wildcard *.uml)
OUTDIR = build

# Output files
SVG  = $(UML:%.uml=$(OUTDIR)/%.svg)
PNG  = $(UML:%.uml=$(OUTDIR)/%.png)
ATXT = $(UML:%.uml=$(OUTDIR)/%.atxt)
UTXT = $(UML:%.uml=$(OUTDIR)/%.utxt)
ALL  = $(SVG) $(PNG) $(ATXT) $(UTXT)

# Compile umls into svgs.
$(OUTDIR)/%.svg: %.uml
	@mkdir -p $(OUTDIR)
	$(CC) -tsvg "$<" -o $(OUTDIR)

# Compile umls into pngs.
$(OUTDIR)/%.png: %.uml
	@mkdir -p $(OUTDIR)
	$(CC) -tpng "$<" -o $(OUTDIR)

# Compile umls into ascii txt diagrams.
$(OUTDIR)/%.atxt: %.uml
	@mkdir -p $(OUTDIR)
	$(CC) -ttxt "$<" -o $(OUTDIR)

# Compile umls into unicode txt diagrams.
$(OUTDIR)/%.utxt: %.uml
	@mkdir -p $(OUTDIR)
	$(CC) -tutxt "$<" -o $(OUTDIR)

# Compile everything. If you add a new format, be sure to include it here!
all: $(ALL)

# Clean up all files generated by this Makefile
.PHONY: clean
clean:
	rm -rf $(OUTDIR)
