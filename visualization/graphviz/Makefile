# Compiles plantuml into a variety of interesting formats.
#
# This Makefile is designed to be easily extended to add new formats, simply
# copy one of the blocks. Main targets like `all` and `clean` are at bottom of
# file.

# Define compiler and output dir.
CC     = dot
DOT    = $(wildcard *.dot)
OUTDIR = build

# Define output.
SVG = $(DOT:%.dot=$(OUTDIR)/%.svg)
PNG = $(DOT:%.dot=$(OUTDIR)/%.png)
ALL = $(SVG) $(PNG)

# Compile uml into svgs.
$(OUTDIR)/%.svg: %.dot
	@mkdir -p $(OUTDIR)
	$(CC) -Tsvg "$<" -o $@

# Compile uml into svgs.
$(OUTDIR)/%.png: %.dot
	@mkdir -p $(OUTDIR)
	$(CC) -Tpng "$<" -o $@

# Compile everything.
all: $(ALL)

# Clean up all files generated by this Makefile.
.PHONY: clean
clean:
	rm -rf $(OUTDIR)
